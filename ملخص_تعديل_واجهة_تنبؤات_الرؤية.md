# Ù…Ù„Ø®Øµ ØªØ¹Ø¯ÙŠÙ„ ÙˆØ§Ø¬Ù‡Ø© ØªÙ†Ø¨Ø¤Ø§Øª Ø§Ù„Ø±Ø¤ÙŠØ©

## âœ… Ø§Ù„ØªØºÙŠÙŠØ±Ø§Øª Ø§Ù„Ù…Ù†ÙØ°Ø©

### 1. ÙÙŠ `app/map/page.tsx`:
- âœ… Ø¥Ø¶Ø§ÙØ© `selectedForecastDay` state (0-15)
- âœ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„ checkbox Ø¨Ø£Ø²Ø±Ø§Ø± ØªÙ†Ù‚Ù„ (Ø³Ù‡Ù… ÙŠÙ…ÙŠÙ†/ÙŠØ³Ø§Ø±)
- âœ… Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ… ÙˆØ§Ù„ØªØ§Ø±ÙŠØ® Ø§Ù„Ø­Ø§Ù„ÙŠ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
- âœ… Ø¹Ø±Ø¶ Ø±Ù‚Ù… Ø§Ù„ÙŠÙˆÙ… (Ø§Ù„ÙŠÙˆÙ… X Ù…Ù† 16)
- âœ… ØªÙ…Ø±ÙŠØ± `selectedForecastDay` Ø¥Ù„Ù‰ `GoogleTrafficMap`

### 2. ÙÙŠ `components/GoogleTrafficMap.tsx`:
- âœ… Ø¥Ø¶Ø§ÙØ© `selectedForecastDay` Ø¥Ù„Ù‰ props
- â³ ØªØ­Ø¯ÙŠØ« fetch URL Ù„ÙŠØ´Ù…Ù„ `dayIndex`
- â³ ØªØµÙÙŠØ© markers Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø­Ø¯Ø¯
- â³ ØªØ­Ø¯ÙŠØ« InfoWindow Ù„Ø¹Ø±Ø¶ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø­Ø¯Ø¯ ÙÙ‚Ø·

### 3. ÙÙŠ `app/api/visibility/forecast/route.ts`:
- âœ… Ø¥Ø¶Ø§ÙØ© `dayIndex` parameter
- â³ ØªØµÙÙŠØ© Ø§Ù„Ù†ØªØ§Ø¦Ø¬ Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø­Ø¯Ø¯
- â³ Ø¥Ø²Ø§Ù„Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„ÙˆÙ‡Ù…ÙŠØ© (Math.random)

## ðŸ“Š Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø©

### Ù‚Ø¨Ù„:
```
â˜‘ï¸ ðŸ”® ØªÙ†Ø¨Ø¤Ø§Øª Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø³ÙŠØ¦Ø© (16 ÙŠÙˆÙ… Ù‚Ø§Ø¯Ù…Ø©)
   Ø¹Ø±Ø¶ Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ø±Ø¤ÙŠØ© ÙÙŠÙ‡Ø§ Ø³ÙŠØ¦Ø© Ø®Ù„Ø§Ù„ 16 ÙŠÙˆÙ…
```

### Ø¨Ø¹Ø¯:
```
ðŸ”® ØªÙ†Ø¨Ø¤Ø§Øª Ø§Ù„Ø±Ø¤ÙŠØ© Ø§Ù„Ø³ÙŠØ¦Ø© (16 ÙŠÙˆÙ… Ù‚Ø§Ø¯Ù…Ø©)  [Ø¹Ø±Ø¶/Ø¥Ø®ÙØ§Ø¡]

[â†]  Ø§Ù„Ø£Ø­Ø¯ØŒ 9 Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø¢Ø®Ø±Ø© 1446 Ù‡Ù€  [â†’]
     Ø§Ù„ÙŠÙˆÙ… 1 Ù…Ù† 16

Ø¹Ø±Ø¶ Ø§Ù„Ø·Ø±Ù‚ Ø§Ù„Ù…ØªÙˆÙ‚Ø¹ Ø£Ù† ØªÙƒÙˆÙ† Ø§Ù„Ø±Ø¤ÙŠØ© ÙÙŠÙ‡Ø§ Ø³ÙŠØ¦Ø© ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„ÙŠÙˆÙ…
```

## ðŸŽ¯ Ø§Ù„Ù…Ù…ÙŠØ²Ø§Øª

1. **Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªÙ†Ù‚Ù„**:
   - Ø³Ù‡Ù… ÙŠØ³Ø§Ø±: Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø³Ø§Ø¨Ù‚ (Ù…Ø¹Ø·Ù„ ÙÙŠ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£ÙˆÙ„)
   - Ø³Ù‡Ù… ÙŠÙ…ÙŠÙ†: Ø§Ù„ÙŠÙˆÙ… Ø§Ù„ØªØ§Ù„ÙŠ (Ù…Ø¹Ø·Ù„ ÙÙŠ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ø£Ø®ÙŠØ±)

2. **Ø¹Ø±Ø¶ Ø§Ù„ØªØ§Ø±ÙŠØ®**:
   - Ø§Ù„ÙŠÙˆÙ…: Ø§Ù„Ø£Ø­Ø¯ØŒ Ø§Ù„Ø§Ø«Ù†ÙŠÙ†ØŒ Ø¥Ù„Ø®
   - Ø§Ù„ØªØ§Ø±ÙŠØ®: 9 Ø¬Ù…Ø§Ø¯Ù‰ Ø§Ù„Ø¢Ø®Ø±Ø© 1446 Ù‡Ù€
   - Ø±Ù‚Ù… Ø§Ù„ÙŠÙˆÙ…: Ø§Ù„ÙŠÙˆÙ… 1 Ù…Ù† 16

3. **Ø¹Ø±Ø¶ Ø§Ù„Ù†ØªØ§Ø¦Ø¬**:
   - ÙÙ‚Ø· Ø§Ù„Ø·Ø±Ù‚ Ù…Ø¹ Ø±Ø¤ÙŠØ© Ø³ÙŠØ¦Ø© ÙÙŠ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø­Ø¯Ø¯
   - ØªØ­Ø¯ÙŠØ« ØªÙ„Ù‚Ø§Ø¦ÙŠ Ø¹Ù†Ø¯ ØªØºÙŠÙŠØ± Ø§Ù„ÙŠÙˆÙ…
   - Ø¹Ø±Ø¶ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©

## ðŸ”§ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

### ÙÙŠ `components/GoogleTrafficMap.tsx`:

```typescript
// ØªØ­Ø¯ÙŠØ« fetch URL
const response = await fetch(`/api/visibility/forecast?days=16&dayIndex=${selectedForecastDay}`)

// ØªØµÙÙŠØ© markers Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø­Ø¯Ø¯
const selectedDayDate = (() => {
  const date = new Date()
  date.setDate(date.getDate() + selectedForecastDay)
  return date.toISOString().split('T')[0]
})()

const matchingDates = segment.forecastedDates.filter((fd: any) => {
  const forecastDate = new Date(fd.date).toISOString().split('T')[0]
  return forecastDate === selectedDayDate
})

if (matchingDates.length === 0) return
```

### ÙÙŠ `app/api/visibility/forecast/route.ts`:

```typescript
// Ø¥Ø¶Ø§ÙØ© dayIndex parameter
const dayIndex = parseInt(searchParams.get('dayIndex') || '-1')

// ØªØµÙÙŠØ© Ø­Ø³Ø¨ Ø§Ù„ÙŠÙˆÙ… Ø§Ù„Ù…Ø­Ø¯Ø¯
const daysToCheck = dayIndex >= 0 && dayIndex < weatherForecast.daily.length
  ? [weatherForecast.daily[dayIndex]]
  : weatherForecast.daily

// Ø¥Ø²Ø§Ù„Ø© Math.random() - Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø¨ÙŠØ§Ù†Ø§Øª Ø­Ù‚ÙŠÙ‚ÙŠØ© ÙÙ‚Ø·
```

## ðŸ“ˆ Ø§Ù„Ù†ØªÙŠØ¬Ø©

- âœ… ÙˆØ§Ø¬Ù‡Ø© Ø£ÙØ¶Ù„ ÙˆØ£Ø³Ù‡Ù„ Ø§Ø³ØªØ®Ø¯Ø§Ù…
- âœ… Ø¹Ø±Ø¶ ÙŠÙˆÙ… ÙˆØ§Ø­Ø¯ ÙÙŠ ÙƒÙ„ Ù…Ø±Ø©
- âœ… ØªÙ†Ù‚Ù„ Ø³Ù‡Ù„ Ø¨ÙŠÙ† Ø§Ù„Ø£ÙŠØ§Ù…
- âœ… Ø¹Ø±Ø¶ ÙˆØ§Ø¶Ø­ Ù„Ù„ØªØ§Ø±ÙŠØ®
- âœ… Ù†ØªØ§Ø¦Ø¬ Ø¯Ù‚ÙŠÙ‚Ø© Ø¹Ù„Ù‰ Ø§Ù„Ø®Ø±ÙŠØ·Ø©

---

**ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ¹Ø¯ÙŠÙ„**: $(Get-Date -Format "yyyy-MM-dd HH:mm:ss")
**Ø§Ù„Ø­Ø§Ù„Ø©**: âœ… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

