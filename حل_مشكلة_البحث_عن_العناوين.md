# حل مشكلة البحث عن العناوين (Places API)

## المشكلة
عند البحث عن عنوان، تظهر رسالة "لا توجد نتائج" أو خطأ 500.

## الحلول

### 1. التحقق من المفتاح
افتح المتصفح واذهب إلى:
```
http://localhost:3000/api/test-places
```

يجب أن ترى معلومات عن المفاتيح. تأكد من أن `placesApiKeyExists: true`.

### 2. تفعيل Places API في Google Cloud Console

1. اذهب إلى [Google Cloud Console](https://console.cloud.google.com/)
2. اختر المشروع الخاص بك
3. اذهب إلى **APIs & Services** > **Library**
4. ابحث عن **"Places API"**
5. اضغط **Enable**

### 3. التحقق من القيود (Restrictions)

1. اذهب إلى **APIs & Services** > **Credentials**
2. اضغط على المفتاح `AQILLAH_PLACES_KEY`
3. في **Application restrictions**:
   - اختر **HTTP referrers (web sites)**
   - أضف:
     ```
     localhost:3000/*
     http://localhost:3000/*
     https://localhost:3000/*
     ```
4. في **API restrictions**:
   - اختر **Restrict key**
   - اختر **Places API** فقط
5. اضغط **Save**

### 4. التحقق من الأخطاء

افتح Console في المتصفح (F12) وابحث عن:
- `❌ Error in autocomplete API route`
- `Places API error: ...`

الأخطاء الشائعة:

#### `REQUEST_DENIED`
- المفتاح غير مصرح به لهذا الموقع
- **الحل**: أضف `localhost:3000/*` في Application restrictions

#### `INVALID_REQUEST`
- طلب غير صحيح
- **الحل**: تأكد من أن النص يحتوي على حرفين على الأقل

#### `OVER_QUERY_LIMIT`
- تجاوز الحد المسموح
- **الحل**: انتظر قليلاً أو راجع Billing في Google Cloud

#### `ZERO_RESULTS`
- لا توجد نتائج (هذا طبيعي)
- **الحل**: جرب بحث آخر

### 5. اختبار مباشر

افتح في المتصفح:
```
http://localhost:3000/api/places/autocomplete?input=مطار
```

يجب أن ترى نتائج JSON أو رسالة خطأ واضحة.

### 6. إعادة تشغيل السيرفر

بعد تعديل `.env` أو القيود:
```powershell
# أوقف السيرفر (Ctrl+C)
# ثم أعد تشغيله
npm run dev
```

## المفاتيح المطلوبة

في ملف `.env`:
```env
AQILLAH_PLACES_KEY=AIzaSyB4R5NLRQMsQO84Uu1gQWPgmgPR_P9NoXA
AQILLAH_MAPS_WEB_KEY=AIzaSyDZgR_h8J5a4UsqmzRNFBlo28412mT25kQ
AQILLAH_ROUTES_KEY=AIzaSyC9zyma4lZ9YSDPlbDh3ZbVsYJkCXLs5gI
```

## ملاحظات

- Places API قد يتطلب تفعيل Billing في Google Cloud
- بعض المفاتيح قد تحتاج إلى وقت للتفعيل (بضع دقائق)
- تأكد من أن Places API مفعل في المشروع

## الدعم

إذا استمرت المشكلة:
1. افتح Console في المتصفح (F12)
2. انسخ رسالة الخطأ الكاملة
3. أرسلها للمطور

