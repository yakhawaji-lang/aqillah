# إصلاح مشكلة قاعدة البيانات - خطوات سريعة

## المشكلة الحالية
```
Can't reach database server at `localhost:3306`
```

## الحل السريع

### الخطوة 1: تشغيل MySQL

#### إذا كنت تستخدم XAMPP:
1. افتح **XAMPP Control Panel**
2. اضغط **Start** بجانب **MySQL**
3. انتظر حتى يظهر **Running** باللون الأخضر

#### إذا كنت تستخدم MySQL Server:
1. افتح **Services** (الخدمات):
   - اضغط `Win + R`
   - اكتب `services.msc` واضغط Enter
2. ابحث عن **MySQL** أو **MySQL80**
3. اضغط كليك يمين → **Start**

### الخطوة 2: التحقق من ملف .env

افتح ملف `.env` في جذر المشروع وتأكد من وجود:

```env
DATABASE_URL="mysql://root:your_password@localhost:3306/aqqilha"
```

**استبدل:**
- `your_password`: كلمة مرور MySQL (اتركها فارغة إذا لم تكن موجودة)
- `aqqilha`: اسم قاعدة البيانات

**مثال:**
```env
DATABASE_URL="mysql://root:@localhost:3306/aqqilha"
```

### الخطوة 3: إنشاء قاعدة البيانات

افتح **Command Prompt** أو **PowerShell** واكتب:

```powershell
# إذا كان لديك كلمة مرور
mysql -u root -p -e "CREATE DATABASE IF NOT EXISTS aqqilha CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"

# إذا لم يكن لديك كلمة مرور
mysql -u root -e "CREATE DATABASE IF NOT EXISTS aqqilha CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;"
```

### الخطوة 4: تطبيق Schema قاعدة البيانات

في نفس المجلد (C:\Aqqilha):

```powershell
npm run db:push
```

### الخطوة 5: إعادة تشغيل Next.js

1. أوقف الخادم الحالي (اضغط `Ctrl + C`)
2. أعد التشغيل:

```powershell
npm run dev
```

## التحقق من الحل

بعد إكمال الخطوات:
1. افتح المتصفح على `http://localhost:3000/user`
2. يجب أن تعمل الصفحة بدون أخطاء قاعدة البيانات

## إذا استمرت المشكلة

### حل 1: استخدام SQLite (بدون MySQL)

إذا لم تكن تريد استخدام MySQL، يمكنك التبديل إلى SQLite:

1. افتح `prisma/schema.prisma`
2. غيّر:
   ```prisma
   datasource db {
     provider = "sqlite"
     url      = env("DATABASE_URL")
   }
   ```
3. غيّر `.env`:
   ```env
   DATABASE_URL="file:./dev.db"
   ```
4. شغّل:
   ```powershell
   npm run db:push
   ```

### حل 2: تثبيت MySQL

إذا لم يكن MySQL مثبتاً:

#### خيار 1: XAMPP (الأسهل)
1. حمّل من: https://www.apachefriends.org/
2. ثبّت XAMPP
3. شغّل MySQL من لوحة التحكم

#### خيار 2: MySQL Server
1. حمّل من: https://dev.mysql.com/downloads/mysql/
2. ثبّت MySQL Server
3. شغّل كخدمة Windows

## نصائح

- ✅ احفظ نسخة احتياطية من `.env` قبل التعديل
- ✅ لا تشارك ملف `.env` في Git
- ✅ استخدم كلمات مرور قوية لقاعدة البيانات
- ✅ راقب السجلات في MySQL للتحقق من الأخطاء

## روابط مفيدة

- [XAMPP Download](https://www.apachefriends.org/)
- [MySQL Download](https://dev.mysql.com/downloads/mysql/)
- [Prisma MySQL Setup](https://www.prisma.io/docs/concepts/database-connectors/mysql)

