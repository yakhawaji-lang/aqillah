# دليل استخدام البيانات الوهمية الواقعية

## نظرة عامة

تم إضافة نظام شامل لإضافة بيانات وهمية واقعية لمحاكاة النظام بشكل كامل. النظام يضيف:

- ✅ مقاطع طرق واقعية في المدن السعودية (الرياض، جدة، الدمام)
- ✅ بيانات حركة مرورية واقعية مع تغييرات زمنية
- ✅ تنبؤات ذكية للازدحام
- ✅ تنبيهات واقعية (ازدحام، حوادث، فعاليات، طقس)
- ✅ بيانات طقس واقعية
- ✅ نقاط ازدحام (Bottlenecks)
- ✅ إحصائيات استخدام

## كيفية الاستخدام

### الطريقة 1: استخدام السكريبت مباشرة

```bash
npm run db:seed
```

هذا الأمر سيقوم بـ:
1. حذف جميع البيانات القديمة
2. إنشاء مقاطع طرق جديدة
3. إضافة بيانات حركة مرورية لآخر 24 ساعة (كل 15 دقيقة)
4. إضافة تنبؤات للـ 5، 10، 30، 60 دقيقة القادمة
5. إضافة تنبيهات عشوائية
6. إضافة بيانات طقس
7. إضافة إحصائيات الاستخدام

### الطريقة 2: استخدام API Endpoint

```bash
POST /api/seed/realistic
```

يمكنك استدعاء هذا الـ endpoint من:
- Postman
- curl
- أي HTTP client

مثال:
```bash
curl -X POST http://localhost:3000/api/seed/realistic
```

## تحديث البيانات الحية

للمحاكاة المستمرة، يمكنك استخدام:

### السكريبت:
```bash
tsx scripts/update-live-data.ts
```

### API Endpoint:
```bash
POST /api/live-data/update
```

هذا سيقوم بتحديث:
- بيانات حركة المرور الحالية
- التنبؤات
- التنبيهات (حذف المنتهية وإضافة جديدة)

## جدولة التحديث التلقائي

يمكنك استخدام cron job أو scheduled task لتحديث البيانات كل دقيقة:

### Windows (Task Scheduler):
```powershell
# تشغيل كل دقيقة
schtasks /create /tn "UpdateLiveData" /tr "tsx scripts/update-live-data.ts" /sc minute /mo 1
```

### Linux/Mac (cron):
```bash
# إضافة إلى crontab
* * * * * cd /path/to/project && tsx scripts/update-live-data.ts >> /var/log/live-data-update.log 2>&1
```

## البيانات المضافة

### مقاطع الطرق

#### الرياض (10 طرق):
- طريق الملك فهد
- طريق العليا
- طريق الدائري الشرقي
- طريق الدائري الغربي
- طريق الملك عبدالعزيز
- طريق الأمير سلطان
- طريق الملك خالد
- طريق العروبة
- طريق التحلية
- طريق الملك سلمان

#### جدة (5 طرق):
- طريق الملك فهد
- طريق الكورنيش
- طريق الملك عبدالعزيز
- طريق الحرمين
- طريق المدينة

#### الدمام (3 طرق):
- طريق الملك فهد
- طريق الكورنيش
- طريق الملك عبدالعزيز

### بيانات الحركة المرورية

- **الفترة**: آخر 24 ساعة
- **التحديث**: كل 15 دقيقة
- **المحاكاة**: 
  - أوقات الذروة (7-9 صباحاً، 5-8 مساءً): ازدحام عالي (60-90)
  - أوقات النهار (10-4): ازدحام متوسط (30-50)
  - أوقات الليل: ازدحام منخفض (20-35)
  - عطلة نهاية الأسبوع: ازدحام أقل

### التنبؤات

- **الفترات**: 5، 10، 30، 60 دقيقة
- **مستوى الثقة**: يقل مع زيادة الفترة
- **العوامل**: الوقت، اليوم، الطقس، الفعاليات

### التنبيهات

- **أنواع**: ازدحام، حادث، فعالية، طقس
- **مستويات الخطورة**: low, medium, high, critical
- **المدة**: 2-6 ساعات
- **الاحتمال**: 30% لكل نوع

### بيانات الطقس

- **درجة الحرارة**: واقعية حسب المدينة
- **الرطوبة**: واقعية حسب المدينة
- **الحالة**: صافي، غائم جزئياً، غائم، مطر، ضباب
- **التوقعات**: ساعية (24 ساعة) ويومية

## ملاحظات مهمة

1. **حذف البيانات**: السكريبت يحذف جميع البيانات القديمة قبل إضافة الجديدة
2. **الأداء**: قد يستغرق السكريبت بضع دقائق لإضافة جميع البيانات
3. **قاعدة البيانات**: تأكد من أن قاعدة البيانات متصلة ومهيأة
4. **الذاكرة**: قد يحتاج السكريبت إلى ذاكرة كافية للبيانات الكبيرة

## استكشاف الأخطاء

### خطأ: "Database connection failed"
- تأكد من تشغيل MySQL
- تحقق من `DATABASE_URL` في ملف `.env`

### خطأ: "Prisma Client not generated"
- قم بتشغيل: `npm run db:generate`

### خطأ: "Tables don't exist"
- قم بتشغيل: `npm run db:push`

## الملفات المضافة

- `scripts/generate-realistic-data.ts` - السكريبت الرئيسي
- `scripts/update-live-data.ts` - سكريبت التحديث المستمر
- `app/api/seed/realistic/route.ts` - API endpoint للإضافة
- `app/api/live-data/update/route.ts` - API endpoint للتحديث

## الدعم

إذا واجهت أي مشاكل، تحقق من:
1. سجلات Console
2. سجلات قاعدة البيانات
3. حالة الاتصال بقاعدة البيانات

